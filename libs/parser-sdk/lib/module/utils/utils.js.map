{"version":3,"names":["parseJson","json","JSON","parse","error","undefined","walkProperties","obj","path","callback","Array","i","length","element","Object","slice","propName","prototype","hasOwnProperty","call","prop","push","pop","formatFHIRRecordDate","dateRaw","tmpDate","indexOf","tmp","Date","getFullYear","getMonth","getDate","join","monthShortNames","year","month","day","split","monthIndex","parseInt","monthShortName","vaccinationDate","propPath","object","props","val"],"sources":["utils.ts"],"sourcesContent":["export function parseJson<T> (json: string): T | undefined {\n    try {\n      return JSON.parse(json) as T\n    } catch (error) {\n      return undefined\n    }\n}\n\nexport function walkProperties (\n  obj: Record<string, unknown>,\n  path: string[],\n  callback: (o: Record<string, unknown>, p: string[]) => void,\n): void {\n  if (obj instanceof Array) {\n    for (let i = 0; i < obj.length; i++) {\n      const element = obj[i] as Record<string, unknown>\n\n      if (element instanceof Object) {\n        walkProperties(element, path.slice(0), callback)\n      }\n    }\n\n    if (obj.length === 0) callback(obj, path)\n\n    return\n  }\n\n  callback(obj, path)\n\n  if (!(obj instanceof Object)) return\n\n  for (const propName in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, propName)) {\n      const prop = obj[propName]\n      path.push(propName)\n      walkProperties(prop as Record<string, unknown>, path.slice(0), callback)\n      path.pop()\n    }\n  }\n  \n}\n\n  \n// NOTE: Timezone affects date presentation, so in US it will be 1 day behind,\n//       that is why `new Date()` is not needed.\n//       Vaccination date in FHIR => \"occurrenceDateTime\": \"2020-12-29\"\nexport const formatFHIRRecordDate = (dateRaw: string): string => {\n  let tmpDate = dateRaw\n\n  if ( dateRaw.indexOf('T') > 0 ) {\n    const tmp = new Date( dateRaw )\n    tmpDate = [ tmp.getFullYear(), ( tmp.getMonth() + 1 ), tmp.getDate() ].join('-')\n  }\n  const monthShortNames = [\n    'Jan',\n    'Feb',\n    'Mar',\n    'Apr',\n    'May',\n    'Jun',\n    'Jul',\n    'Aug',\n    'Sep',\n    'Oct',\n    'Nov',\n    'Dec',\n  ]\n\n  const [year, month, day] = tmpDate.split('-')\n  const monthIndex = parseInt(month, 10) - 1 // 08 -> 7\n  const monthShortName = monthShortNames[monthIndex]\n\n  const vaccinationDate = `${day} ${monthShortName} ${year}`\n\n  return vaccinationDate\n}\n\n\nexport function propPath (object: Record<string, unknown>, path: string): string | undefined {\n  const props = path.split('.')\n  let val = object\n\n  for (let i = 1; i < props.length; i++) {\n    val = val[props[i]] as Record<string, Record<string, unknown>>\n\n    if (val instanceof Array)\n      val = val.length === 0 ? val : (val[0] as Record<string, Record<string, unknown>>)\n    if (val === undefined) return val\n  }\n\n  return val as unknown as string\n}\n"],"mappings":"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"}