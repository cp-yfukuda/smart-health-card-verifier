{"version":3,"names":["parseJson","json","JSON","parse","error","undefined","walkProperties","obj","path","callback","Array","i","length","element","Object","slice","propName","prototype","hasOwnProperty","call","prop","push","pop","formatFHIRRecordDate","dateRaw","tmpDate","indexOf","tmp","Date","getFullYear","getMonth","getDate","join","monthShortNames","year","month","day","split","monthIndex","parseInt","monthShortName","vaccinationDate","propPath","object","props","val"],"sources":["utils.ts"],"sourcesContent":["export function parseJson<T> (json: string): T | undefined {\n    try {\n      return JSON.parse(json) as T\n    } catch (error) {\n      return undefined\n    }\n}\n\nexport function walkProperties (\n  obj: Record<string, unknown>,\n  path: string[],\n  callback: (o: Record<string, unknown>, p: string[]) => void,\n): void {\n  if (obj instanceof Array) {\n    for (let i = 0; i < obj.length; i++) {\n      const element = obj[i] as Record<string, unknown>\n\n      if (element instanceof Object) {\n        walkProperties(element, path.slice(0), callback)\n      }\n    }\n\n    if (obj.length === 0) callback(obj, path)\n\n    return\n  }\n\n  callback(obj, path)\n\n  if (!(obj instanceof Object)) return\n\n  for (const propName in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, propName)) {\n      const prop = obj[propName]\n      path.push(propName)\n      walkProperties(prop as Record<string, unknown>, path.slice(0), callback)\n      path.pop()\n    }\n  }\n  \n}\n\n  \n// NOTE: Timezone affects date presentation, so in US it will be 1 day behind,\n//       that is why `new Date()` is not needed.\n//       Vaccination date in FHIR => \"occurrenceDateTime\": \"2020-12-29\"\nexport const formatFHIRRecordDate = (dateRaw: string): string => {\n  let tmpDate = dateRaw\n\n  if ( dateRaw.indexOf('T') > 0 ) {\n    const tmp = new Date( dateRaw )\n    tmpDate = [ tmp.getFullYear(), ( tmp.getMonth() + 1 ), tmp.getDate() ].join('-')\n  }\n  const monthShortNames = [\n    'Jan',\n    'Feb',\n    'Mar',\n    'Apr',\n    'May',\n    'Jun',\n    'Jul',\n    'Aug',\n    'Sep',\n    'Oct',\n    'Nov',\n    'Dec',\n  ]\n\n  const [year, month, day] = tmpDate.split('-')\n  const monthIndex = parseInt(month, 10) - 1 // 08 -> 7\n  const monthShortName = monthShortNames[monthIndex]\n\n  const vaccinationDate = `${day} ${monthShortName} ${year}`\n\n  return vaccinationDate\n}\n\n\nexport function propPath (object: Record<string, unknown>, path: string): string | undefined {\n  const props = path.split('.')\n  let val = object\n\n  for (let i = 1; i < props.length; i++) {\n    val = val[props[i]] as Record<string, Record<string, unknown>>\n\n    if (val instanceof Array)\n      val = val.length === 0 ? val : (val[0] as Record<string, Record<string, unknown>>)\n    if (val === undefined) return val\n  }\n\n  return val as unknown as string\n}\n"],"mappings":"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"}