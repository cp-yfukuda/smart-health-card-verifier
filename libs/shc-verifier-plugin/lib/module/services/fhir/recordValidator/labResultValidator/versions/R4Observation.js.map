{"version":3,"names":["getVerifierInitOption","R4Observation","canSupport","entry","_entry$resource","_entry$resource$code","isAcceptedResult","isAcceptedLabResult","coding","resource","code","filter","item","system","length","validate","res","acceptedStatuses","status","isObservationCompleteStatus","includes","String","console","log","_entry$resource2","_entry$resource2$code","Promise","resolve"],"sources":["R4Observation.ts"],"sourcesContent":["import { getVerifierInitOption } from '../../../../../models/Config'\nimport type { ObservationValidator, BundleEntry } from '../../../types' \nclass R4Observation implements ObservationValidator {\n\n  canSupport (entry: BundleEntry): boolean {\n    const isAcceptedResult = getVerifierInitOption().isAcceptedLabResult\n    const coding = ( entry?.resource?.code?.coding ?? [] ).filter(( item: any ) => {\n      return isAcceptedResult( item.system, item.code )\n    })\n    return ( coding.length > 0 )\n  }\n    \n  async validate ( entry: BundleEntry ): Promise<boolean> {\n    let res = true\n    const acceptedStatuses = ['final', 'amended', 'corrected']\n    if ( this.canSupport( entry ) ) {\n      const { status } = entry.resource || ''\n      const isObservationCompleteStatus = acceptedStatuses.includes( String( status )  )\n      console.log('isObservationCompleteStatus - ' + isObservationCompleteStatus)\n      if (!isObservationCompleteStatus) {\n        console.log(`Observation.status should be \"final, amended, corrected\", but it is ${String(status)}`)\n        res = false\n      }\n    } else {\n      res = false\n      console.log(`Observation.system ${String(entry?.resource?.code?.coding)} should be supported`)\n    } \n    return Promise.resolve( res )\n  }\n}\n\nexport default R4Observation\n"],"mappings":"AAAA,SAASA,qBAAqB,QAAQ,8BAA8B;AAEpE,MAAMC,aAAa,CAAiC;EAElDC,UAAUA,CAAEC,KAAkB,EAAW;IAAA,IAAAC,eAAA,EAAAC,oBAAA;IACvC,MAAMC,gBAAgB,GAAGN,qBAAqB,EAAE,CAACO,mBAAmB;IACpE,MAAMC,MAAM,GAAG,CAAE,CAAAL,KAAK,aAALA,KAAK,wBAAAC,eAAA,GAALD,KAAK,CAAEM,QAAQ,cAAAL,eAAA,wBAAAC,oBAAA,GAAfD,eAAA,CAAiBM,IAAI,cAAAL,oBAAA,uBAArBA,oBAAA,CAAuBG,MAAM,KAAI,EAAE,EAAGG,MAAM,CAAGC,IAAS,IAAM;MAC7E,OAAON,gBAAgB,CAAEM,IAAI,CAACC,MAAM,EAAED,IAAI,CAACF,IAAI,CAAE;IACnD,CAAC,CAAC;IACF,OAASF,MAAM,CAACM,MAAM,GAAG,CAAC;EAC5B;EAEA,MAAMC,QAAQA,CAAGZ,KAAkB,EAAqB;IACtD,IAAIa,GAAG,GAAG,IAAI;IACd,MAAMC,gBAAgB,GAAG,CAAC,OAAO,EAAE,SAAS,EAAE,WAAW,CAAC;IAC1D,IAAK,IAAI,CAACf,UAAU,CAAEC,KAAK,CAAE,EAAG;MAC9B,MAAM;QAAEe;MAAO,CAAC,GAAGf,KAAK,CAACM,QAAQ,IAAI,EAAE;MACvC,MAAMU,2BAA2B,GAAGF,gBAAgB,CAACG,QAAQ,CAAEC,MAAM,CAAEH,MAAM,CAAE,CAAG;MAClFI,OAAO,CAACC,GAAG,CAAC,gCAAgC,GAAGJ,2BAA2B,CAAC;MAC3E,IAAI,CAACA,2BAA2B,EAAE;QAChCG,OAAO,CAACC,GAAG,CAAE,uEAAsEF,MAAM,CAACH,MAAM,CAAE,EAAC,CAAC;QACpGF,GAAG,GAAG,KAAK;MACb;IACF,CAAC,MAAM;MAAA,IAAAQ,gBAAA,EAAAC,qBAAA;MACLT,GAAG,GAAG,KAAK;MACXM,OAAO,CAACC,GAAG,CAAE,sBAAqBF,MAAM,CAAClB,KAAK,aAALA,KAAK,wBAAAqB,gBAAA,GAALrB,KAAK,CAAEM,QAAQ,cAAAe,gBAAA,wBAAAC,qBAAA,GAAfD,gBAAA,CAAiBd,IAAI,cAAAe,qBAAA,uBAArBA,qBAAA,CAAuBjB,MAAM,CAAE,sBAAqB,CAAC;IAChG;IACA,OAAOkB,OAAO,CAACC,OAAO,CAAEX,GAAG,CAAE;EAC/B;AACF;AAEA,eAAef,aAAa"}