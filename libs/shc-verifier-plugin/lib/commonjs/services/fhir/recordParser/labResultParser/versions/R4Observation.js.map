{"version":3,"names":["R4Observation","parse","entry","verifierOption","getVerifierInitOption","unknownSystem","status","code","performer","meta","valueCodeableConcept","effectiveDateTime","resource","systemCoding","coding","securityCode","security","system","getAcceptedSystemCode","systemName","display","performerName","getPerformerLabel","systemKey","systemCode","systemShortDefault","shortDefault","codableConseptKey","codableConseptLabel","codableConseptCode","codeableShortDefault","codableCoding","codableSystem","getSystemCodeLabel","e","console","info","performers","res"],"sources":["R4Observation.ts"],"sourcesContent":["import { getVerifierInitOption } from '../../../../../models/Config'\nimport type { ObservationParser, BundleEntry } from '../../../types'\nexport default class R4Observation implements ObservationParser {\n  parse ( entry: BundleEntry ): any {\n    const verifierOption = getVerifierInitOption();\n    try {\n      const unknownSystem   = null\n      const { status, code, performer, meta, valueCodeableConcept, effectiveDateTime } = entry?.resource\n      const systemCoding =  code?.coding[0]\n      const securityCode = meta?.security ? ( meta?.security[0]?.code ??  null ) : null\n      const system = verifierOption.getAcceptedSystemCode( systemCoding.system, systemCoding.code )\n      const systemName = system.display ?? unknownSystem\n      const performerName = this.getPerformerLabel( performer )\n      const systemKey  = system?.systemKey ?? unknownSystem\n      const systemCode = system?.code ?? unknownSystem\n      const systemShortDefault = system?.shortDefault ?? null\n      let codableConseptKey   = null\n      let codableConseptLabel: string | null = null\n      let codableConseptCode  = null\n      let codeableShortDefault = null\n      if ( valueCodeableConcept?.coding[0] ) {\n        const codableCoding  = valueCodeableConcept?.coding[0]\n        const codableSystem = verifierOption.getAcceptedSystemCode( codableCoding.system, codableCoding.code )\n        codableConseptLabel = verifierOption.getSystemCodeLabel( codableSystem.system, codableSystem.code )\n        codableConseptKey   = codableSystem.systemKey\n        codableConseptCode  = codableSystem.code\n        codeableShortDefault = codableSystem.codeableShortDefault ?? null\n      }\n      return {\n        securityCode,\n        status,\n        performer: performerName,\n        systemName,\n        systemKey,\n        systemCode,\n        systemShortDefault,\n        effectiveDateTime,\n        codableConseptLabel,\n        codableConseptKey,\n        codableConseptCode,\n        codeableShortDefault\n      }\n\n    } catch ( e ) {\n      console.info(e)\n\n    }\n  }\n\n  getPerformerLabel ( performers: Array<Record<any, any>> | undefined ): string | null {\n    let res = null\n    if ( performers ) {\n      res = performers[0].display ? performers[0].display : null \n    } \n    return res\n  }\n}\n"],"mappings":"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"}