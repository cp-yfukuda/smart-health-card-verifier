{"version":3,"names":["R4Observation","parse","entry","verifierOption","getVerifierInitOption","unknownSystem","status","code","performer","meta","valueCodeableConcept","effectiveDateTime","resource","systemCoding","coding","securityCode","security","system","getAcceptedSystemCode","systemName","display","performerName","getPerformerLabel","systemKey","systemCode","systemShortDefault","shortDefault","codableConseptKey","codableConseptLabel","codableConseptCode","codeableShortDefault","codableCoding","codableSystem","getSystemCodeLabel","e","console","info","performers","res"],"sources":["R4Observation.ts"],"sourcesContent":["import { getVerifierInitOption } from '../../../../../models/Config'\nimport type { ObservationParser, BundleEntry } from '../../../types'\nexport default class R4Observation implements ObservationParser {\n  parse ( entry: BundleEntry ): any {\n    const verifierOption = getVerifierInitOption();\n    try {\n      const unknownSystem   = null\n      const { status, code, performer, meta, valueCodeableConcept, effectiveDateTime } = entry?.resource\n      const systemCoding =  code?.coding[0]\n      const securityCode = meta?.security ? ( meta?.security[0]?.code ??  null ) : null\n      const system = verifierOption.getAcceptedSystemCode( systemCoding.system, systemCoding.code )\n      const systemName = system.display ?? unknownSystem\n      const performerName = this.getPerformerLabel( performer )\n      const systemKey  = system?.systemKey ?? unknownSystem\n      const systemCode = system?.code ?? unknownSystem\n      const systemShortDefault = system?.shortDefault ?? null\n      let codableConseptKey   = null\n      let codableConseptLabel: string | null = null\n      let codableConseptCode  = null\n      let codeableShortDefault = null\n      if ( valueCodeableConcept?.coding[0] ) {\n        const codableCoding  = valueCodeableConcept?.coding[0]\n        const codableSystem = verifierOption.getAcceptedSystemCode( codableCoding.system, codableCoding.code )\n        codableConseptLabel = verifierOption.getSystemCodeLabel( codableSystem.system, codableSystem.code )\n        codableConseptKey   = codableSystem.systemKey\n        codableConseptCode  = codableSystem.code\n        codeableShortDefault = codableSystem.codeableShortDefault ?? null\n      }\n\n      return {\n        securityCode,\n        status,\n        performer: performerName,\n        systemName,\n        systemKey,\n        systemCode,\n        systemShortDefault,\n        effectiveDateTime,\n        codableConseptLabel,\n        codableConseptKey,\n        codableConseptCode,\n        codeableShortDefault\n      }\n\n    } catch ( e ) {\n      console.info(e)\n\n    }\n  }\n\n  getPerformerLabel ( performers: Array<Record<any, any>> | undefined ): string | null {\n    let res = null\n    if ( performers ) {\n      res = performers[0].display ? performers[0].display : null \n    } \n    return res\n  }\n}\n"],"mappings":"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"}