{"version":3,"names":["R4Observation","canSupport","entry","isAcceptedResult","getVerifierInitOption","isAcceptedLabResult","coding","resource","code","filter","item","system","length","validate","res","acceptedStatuses","status","isObservationCompleteStatus","includes","String","console","log","Promise","resolve"],"sources":["R4Observation.ts"],"sourcesContent":["import { getVerifierInitOption } from '../../../../../models/Config'\nimport type { ObservationValidator, BundleEntry } from '../../../types' \nclass R4Observation implements ObservationValidator {\n\n  canSupport (entry: BundleEntry): boolean {\n    const isAcceptedResult = getVerifierInitOption().isAcceptedLabResult\n    const coding = ( entry?.resource?.code?.coding ?? [] ).filter(( item: any ) => {\n      return isAcceptedResult( item.system, item.code )\n    })\n    return ( coding.length > 0 )\n  }\n    \n  async validate ( entry: BundleEntry ): Promise<boolean> {\n    let res = true\n    const acceptedStatuses = ['final', 'amended', 'corrected']\n    if ( this.canSupport( entry ) ) {\n      const { status } = entry.resource || ''\n      const isObservationCompleteStatus = acceptedStatuses.includes( String( status )  )\n      console.log('isObservationCompleteStatus - ' + isObservationCompleteStatus)\n      if (!isObservationCompleteStatus) {\n        console.log(`Observation.status should be \"final, amended, corrected\", but it is ${String(status)}`)\n        res = false\n      }\n    } else {\n      res = false\n      console.log(`Observation.system ${String(entry?.resource?.code?.coding)} should be supported`)\n    } \n    return Promise.resolve( res )\n  }\n}\n\nexport default R4Observation\n"],"mappings":";;;;;;AAAA;AAEA,MAAMA,aAAa,CAAiC;EAElDC,UAAU,CAAEC,KAAkB,EAAW;IAAA;IACvC,MAAMC,gBAAgB,GAAG,IAAAC,6BAAqB,GAAE,CAACC,mBAAmB;IACpE,MAAMC,MAAM,GAAG,CAAE,CAAAJ,KAAK,aAALA,KAAK,0CAALA,KAAK,CAAEK,QAAQ,4EAAf,gBAAiBC,IAAI,yDAArB,qBAAuBF,MAAM,KAAI,EAAE,EAAGG,MAAM,CAAGC,IAAS,IAAM;MAC7E,OAAOP,gBAAgB,CAAEO,IAAI,CAACC,MAAM,EAAED,IAAI,CAACF,IAAI,CAAE;IACnD,CAAC,CAAC;IACF,OAASF,MAAM,CAACM,MAAM,GAAG,CAAC;EAC5B;EAEA,MAAMC,QAAQ,CAAGX,KAAkB,EAAqB;IACtD,IAAIY,GAAG,GAAG,IAAI;IACd,MAAMC,gBAAgB,GAAG,CAAC,OAAO,EAAE,SAAS,EAAE,WAAW,CAAC;IAC1D,IAAK,IAAI,CAACd,UAAU,CAAEC,KAAK,CAAE,EAAG;MAC9B,MAAM;QAAEc;MAAO,CAAC,GAAGd,KAAK,CAACK,QAAQ,IAAI,EAAE;MACvC,MAAMU,2BAA2B,GAAGF,gBAAgB,CAACG,QAAQ,CAAEC,MAAM,CAAEH,MAAM,CAAE,CAAG;MAClFI,OAAO,CAACC,GAAG,CAAC,gCAAgC,GAAGJ,2BAA2B,CAAC;MAC3E,IAAI,CAACA,2BAA2B,EAAE;QAChCG,OAAO,CAACC,GAAG,CAAE,uEAAsEF,MAAM,CAACH,MAAM,CAAE,EAAC,CAAC;QACpGF,GAAG,GAAG,KAAK;MACb;IACF,CAAC,MAAM;MAAA;MACLA,GAAG,GAAG,KAAK;MACXM,OAAO,CAACC,GAAG,CAAE,sBAAqBF,MAAM,CAACjB,KAAK,aAALA,KAAK,2CAALA,KAAK,CAAEK,QAAQ,8EAAf,iBAAiBC,IAAI,0DAArB,sBAAuBF,MAAM,CAAE,sBAAqB,CAAC;IAChG;IACA,OAAOgB,OAAO,CAACC,OAAO,CAAET,GAAG,CAAE;EAC/B;AACF;AAAC,eAEcd,aAAa;AAAA"}